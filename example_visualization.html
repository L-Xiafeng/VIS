<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>苏州园林地图 - Suzhou Gardens Map</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, "Microsoft YaHei", sans-serif;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
        }
        #info {
            max-width: 1200px;
            margin: 0 auto 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }
        #map-container {
            max-width: 1200px;
            margin: 0 auto;
            height: 600px;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
            position: relative;
            background: #e8f4f8;
        }
        .marker {
            position: absolute;
            width: 8px;
            height: 8px;
            background-color: #e74c3c;
            border: 2px solid white;
            border-radius: 50%;
            cursor: pointer;
            transform: translate(-50%, -50%);
            transition: all 0.2s;
        }
        .marker:hover {
            width: 12px;
            height: 12px;
            background-color: #c0392b;
            z-index: 1000;
        }
        .marker.unesco {
            background-color: #2ecc71;
            width: 10px;
            height: 10px;
        }
        .marker.unesco:hover {
            width: 14px;
            height: 14px;
            background-color: #27ae60;
        }
        .tooltip {
            position: absolute;
            background: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            pointer-events: none;
            display: none;
            z-index: 2000;
            max-width: 250px;
        }
        .tooltip.show {
            display: block;
        }
        .stats {
            margin-top: 10px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 10px;
        }
        .stat-box {
            padding: 10px;
            background: white;
            border-left: 4px solid #3498db;
            border-radius: 3px;
        }
        .legend {
            margin-top: 20px;
            padding: 10px;
            background: white;
            border-radius: 5px;
        }
        .legend-item {
            display: inline-block;
            margin-right: 20px;
        }
        .legend-color {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 5px;
            vertical-align: middle;
        }
        .note {
            margin-top: 10px;
            font-size: 0.9em;
            color: #7f8c8d;
            font-style: italic;
        }
    </style>
</head>
<body>
    <h1>🏛️ 苏州园林地图可视化示例 / Suzhou Gardens Visualization Example</h1>
    
    <div id="info">
        <h2>数据统计 / Statistics</h2>
        <div class="stats">
            <div class="stat-box">
                <strong>总园林数 / Total Gardens:</strong> <span id="total">-</span>
            </div>
            <div class="stat-box">
                <strong>世界遗产 / UNESCO Sites:</strong> <span id="unesco">-</span>
            </div>
            <div class="stat-box">
                <strong>覆盖范围 / Coverage:</strong> <span id="coverage">-</span>
            </div>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <span class="legend-color" style="background-color: #2ecc71;"></span>
                世界遗产园林 / UNESCO Heritage Gardens
            </div>
            <div class="legend-item">
                <span class="legend-color" style="background-color: #e74c3c;"></span>
                其他园林 / Other Gardens
            </div>
        </div>
        
        <div class="note">
            注：此为简化的示例可视化。实际应用中建议使用 Leaflet.js、百度地图或高德地图等专业地图库。<br>
            Note: This is a simplified visualization example. For production use, consider Leaflet.js, Baidu Maps, or Gaode Maps.
        </div>
    </div>
    
    <div id="map-container">
        <div class="tooltip" id="tooltip"></div>
    </div>

    <script>
        // Load the garden data
        async function loadGardenData() {
            try {
                const response = await fetch('dataset/ylml.json');
                const gardens = await response.json();
                
                // Famous UNESCO gardens
                const unescoGardens = [
                    '拙政园', '留园', '网师园', '狮子林', 
                    '沧浪亭', '耦园', '艺圃', '退思园', '环秀山庄'
                ];
                
                // Calculate bounds
                let minLat = Infinity, maxLat = -Infinity;
                let minLng = Infinity, maxLng = -Infinity;
                
                gardens.forEach(garden => {
                    const gps = garden.basicInfo.gps;
                    if (gps.latitude && gps.longitude) {
                        minLat = Math.min(minLat, gps.latitude);
                        maxLat = Math.max(maxLat, gps.latitude);
                        minLng = Math.min(minLng, gps.longitude);
                        maxLng = Math.max(maxLng, gps.longitude);
                    }
                });
                
                // Update stats
                document.getElementById('total').textContent = gardens.length;
                document.getElementById('unesco').textContent = 
                    gardens.filter(g => unescoGardens.includes(g.basicInfo.officialName)).length;
                document.getElementById('coverage').textContent = 
                    `${minLat.toFixed(2)}°N - ${maxLat.toFixed(2)}°N, ${minLng.toFixed(2)}°E - ${maxLng.toFixed(2)}°E`;
                
                // Render markers
                const container = document.getElementById('map-container');
                const tooltip = document.getElementById('tooltip');
                
                gardens.forEach(garden => {
                    const gps = garden.basicInfo.gps;
                    if (!gps.latitude || !gps.longitude) return;
                    
                    // Convert GPS to pixel coordinates (simplified projection)
                    const x = ((gps.longitude - minLng) / (maxLng - minLng)) * 100;
                    const y = ((maxLat - gps.latitude) / (maxLat - minLat)) * 100;
                    
                    const marker = document.createElement('div');
                    marker.className = 'marker';
                    marker.style.left = x + '%';
                    marker.style.top = y + '%';
                    
                    if (unescoGardens.includes(garden.basicInfo.officialName)) {
                        marker.classList.add('unesco');
                    }
                    
                    // Tooltip on hover
                    marker.addEventListener('mouseenter', (e) => {
                        tooltip.innerHTML = `
                            <strong>${garden.basicInfo.officialName}</strong><br>
                            地址: ${garden.basicInfo.address}<br>
                            GPS: ${gps.latitude.toFixed(6)}, ${gps.longitude.toFixed(6)}
                        `;
                        tooltip.style.left = e.clientX + 10 + 'px';
                        tooltip.style.top = e.clientY + 10 + 'px';
                        tooltip.classList.add('show');
                    });
                    
                    marker.addEventListener('mouseleave', () => {
                        tooltip.classList.remove('show');
                    });
                    
                    marker.addEventListener('mousemove', (e) => {
                        tooltip.style.left = e.clientX + 10 + 'px';
                        tooltip.style.top = e.clientY + 10 + 'px';
                    });
                    
                    container.appendChild(marker);
                });
                
                console.log(`Loaded ${gardens.length} gardens with GPS coordinates`);
                
            } catch (error) {
                console.error('Error loading garden data:', error);
                document.getElementById('info').innerHTML += 
                    '<p style="color: red;">Error loading data. Please ensure the dataset/ylml.json file is in the correct location.</p>';
            }
        }
        
        // Load data when page loads
        loadGardenData();
    </script>
</body>
</html>
